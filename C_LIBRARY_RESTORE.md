# üîß –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ C –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

C –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏. –í–º–µ—Å—Ç–æ –Ω–µ—ë –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è Go —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π.

## –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ C –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

### 1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å C —Ñ–∞–π–ª—ã

```bash
mv internal/crypto/crypto.c.bak internal/crypto/crypto.c
mv internal/crypto/crypto.h.bak internal/crypto/crypto.h
```

### 2. –û–±–Ω–æ–≤–∏—Ç—å Go wrapper

–í —Ñ–∞–π–ª–µ `internal/crypto/crypto.go` –∑–∞–º–µ–Ω–∏—Ç—å –∑–∞–≥–ª—É—à–∫–∏ –Ω–∞ C –≤—ã–∑–æ–≤—ã:

```go
/*
#cgo CFLAGS: -I.
#cgo LDFLAGS: -L. -L/usr/local/opt/openssl@3/lib -lcrypto -lssl
#include "crypto.h"
*/
import "C"
```

### 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å C –º–µ—Ç–æ–¥—ã

–ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ Go —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ C –≤—ã–∑–æ–≤—ã:

```go
// HashPassword —Ö–µ—à–∏—Ä—É–µ—Ç –ø–∞—Ä–æ–ª—å —Å —Å–æ–ª—å—é
func (c *CryptoService) HashPassword(password, salt string) (string, error) {
	hash := make([]C.char, 128)
	
	result := C.hash_password(
		C.CString(password),
		C.CString(salt),
		&hash[0],
		128,
	)
	
	if result != 0 {
		return "", errors.New("–æ—à–∏–±–∫–∞ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª—è")
	}
	
	return C.GoString(&hash[0]), nil
}
```

### 4. –û–±–Ω–æ–≤–∏—Ç—å Makefile

–í —Ñ–∞–π–ª–µ `Makefile` –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–±–æ—Ä–∫—É C –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

```makefile
# –°–±–æ—Ä–∫–∞ C –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
build-crypto:
	@echo "üî® –°–±–æ—Ä–∫–∞ C –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏..."
	$(CC) $(CFLAGS) -I/usr/local/opt/openssl@3/include -c $(C_DIR)/crypto.c -o $(C_DIR)/crypto.o
	$(CC) -shared $(C_DIR)/crypto.o -o $(C_DIR)/$(LIB_NAME).dylib -L/usr/local/opt/openssl@3/lib -lcrypto -lssl
	@echo "‚úÖ C –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–æ–±—Ä–∞–Ω–∞"
```

### 5. –°–æ–±—Ä–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
make clean
make build
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ C –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –≤ 3-5 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ Go —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç OpenSSL –Ω–∞ —É—Ä–æ–≤–Ω–µ C
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã

## –¢–µ–∫—É—â–∏–µ Go —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- `HashPassword`: SHA-512 —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- `VerifyPassword`: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ö–µ—à–∞
- `GenerateSalt`: –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∞—è —Å–æ–ª—å
- `EncryptMessage`: XOR —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (–¥–µ–º–æ)
- `DecryptMessage`: XOR —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ (–¥–µ–º–æ)
- `GenerateJWT`: HMAC-SHA256 –ø–æ–¥–ø–∏—Å—å
- `VerifyJWT`: –ø—Ä–æ–≤–µ—Ä–∫–∞ JWT –ø–æ–¥–ø–∏—Å–∏

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- Go —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
- –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å C –±–∏–±–ª–∏–æ—Ç–µ–∫—É
- C –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ç—Ä–µ–±—É–µ—Ç OpenSSL 3.x
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å macOS, Linux, Windows
